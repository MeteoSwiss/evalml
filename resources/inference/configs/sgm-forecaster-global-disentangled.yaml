input:
  test:
    use_original_paths: true

allow_nans: true

output:
  tee:
    - grib:
        path: grib/{dateTime}_{step:03}.grib
        encoding:
          typeOfGeneratingProcess: 2
        templates:
          samples: resources/templates_index_cosmo.yaml
        negative_step_mode: skip
        post_processors:
          - extract_mask: # removes global points
              mask: "lam_0/cutout_mask"
              as_slice: true
    - grib:
        path: grib/ifs-{dateTime}_{step:03}.grib
        encoding:
          typeOfGeneratingProcess: 2
        templates:
          samples: resources/templates_index_ifs.yaml
        negative_step_mode: skip
        post_processors:
        - extract_mask: # removes lam points
            mask: "lam_0/cutout_mask"
            as_slice: true
            inverse: true
        - assign_mask: # fill local/global overlapping points with nan
            mask: "global/cutout_mask"

write_initial_state: true
